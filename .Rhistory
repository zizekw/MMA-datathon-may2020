scale_y_continuous(limits = c(0,200), expand = c(0,0)) + # base amount should work by here
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 0, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(0,200), expand = c(0,0)) + # base amount should work by here
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
?stat
?level
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 0, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(0,200), expand = c(0,0)) + # base amount should work by here
geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8) +
theme(axis,title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 17),
legend.position ="none")
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 0, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(0,200), expand = c(0,0)) + # base amount should work by here
geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
?annotation_raster
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 0, ymax = 200) +
# scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
# scale_y_continuous(limits = c(0,200), expand = c(0,0)) + # base amount should work by here
geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 0, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(0,200), expand = c(0,0)) + # base amount should work by here
geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
?scale_x_continuous
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 0, ymax = 200) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
# load ggplot2, grideExtra, grid, dplyr, and he used glmmTMB for modeling
# img.file <- system.file(file.path("images", "background-image.png"), package = "ggpubr")
img <- png::readPNG("full-rink.png")
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 0, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(0,200), expand = c(0,0)) + # base amount should work by here
geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
# load ggplot2, grideExtra, grid, dplyr, and he used glmmTMB for modeling
# img.file <- system.file(file.path("images", "background-image.png"), package = "ggpubr")
img <- png::readPNG("full-rink-crop.png")
ggplot(data = shot_data, aes(x_event, y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
geom_point()
ggplot(data = shot_data, aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
geom_point()
ggplot(data = data, aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
ggplot(data = data, aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8)
install.packages("viridis")
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "viridis", alpha = 0.2, col = "white", bins = 8)
ggplot(colors())
ggplot(colors
)
library("viridis")
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8) + scale_colour_viridis()
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = scale_colour_viridis(), alpha = 0.2, col = "white", bins = 8)
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = scale_fill_viridis(), alpha = 0.2, col = "white", bins = 8)
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "steelblue4", alpha = 0.2, col = "white", bins = 8) + scale_fill_viridis()
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "red3", alpha = 0.2, col = "white", bins = 8)
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = x_event, y = y_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8)
img <- png::readPNG("ozone.png")
# need to filter current data for zone potentially - example was all purely offensive zone
p1 <- ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 100, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8)
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 100, xmax = 200, ymin = 0, ymax = 85) +
scale_x_continuous(limits = c(0,200), expand = c(0,0)) +
scale_y_continuous(limits = c(0,85), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8)
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0))
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8)
# load ggplot2, grideExtra, grid, dplyr, and he used glmmTMB for modeling
# img.file <- system.file(file.path("images", "background-image.png"), package = "ggpubr")
img <- png::readPNG("ozone.png")
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8)
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 17),
legend.position ="none") +
ggtitle("Patrik laine")
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 17),
legend.position ="none") +
ggtitle("suck it kirill") +
coord_fixed(xlim = c(0, 85), ylim = c(100, 200))
# load ggplot2, grideExtra, grid, dplyr, and he used glmmTMB for modeling
# img.file <- system.file(file.path("images", "background-image.png"), package = "ggpubr")
img <- png::readPNG("ozone.png")
# need to filter current data for zone potentially - example was all purely offensive zone
p1 <- ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 17),
legend.position ="none") +
ggtitle("Offensive Zone Shot Data") +
# subtitle with team name focused on + game
coord_fixed(xlim = c(0, 85), ylim = c(100, 200)) +
geom_rect(aes(xmin = 10, xmax = 75, ymin = 103, ymax = 110), colour = "black", size = 1, fill = "lightblue") +
annotate("text", label = "Expected Shooting %: 6.3%", x = 42.5, y = 107, size = 5) +
geom_segment(data = data.frame(x = c(38.25, 38.25, 20.75, 20.75, 64.25, 64.25),
y = c(188, 188, 168.5, 153.5, 153.5, 168.5),
xend = c(46.75, 20.75, 20.75, 64.25), 64.25, 46.75),
yend = c(188, 168.5, 153.5, 153.5, 168.5, 188),
aes(x = x, y = y, xend = xend, yend = yend),
size = 1, col = "midnightblue", linetype = 2)
# load ggplot2, grideExtra, grid, dplyr, and he used glmmTMB for modeling
# img.file <- system.file(file.path("images", "background-image.png"), package = "ggpubr")
img <- png::readPNG("ozone.png")
# need to filter current data for zone potentially - example was all purely offensive zone
p1 <- ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 17),
legend.position ="none") +
ggtitle("Offensive Zone Shot Data") +
# subtitle with team name focused on + game
coord_fixed(xlim = c(0, 85), ylim = c(100, 200)) +
geom_rect(aes(xmin = 10, xmax = 75, ymin = 103, ymax = 110), colour = "black", size = 1, fill = "lightblue") +
annotate("text", label = "Expected Shooting %: 6.3%", x = 42.5, y = 107, size = 5) +
geom_segment(data = data.frame(x = c(38.25, 38.25, 20.75, 20.75, 64.25, 64.25),
y = c(188, 188, 168.5, 153.5, 153.5, 168.5),
xend = c(46.75, 20.75, 20.75, 64.25, 64.25, 46.75),
yend = c(188, 168.5, 153.5, 153.5, 168.5, 188),
aes(x = x, y = y, xend = xend, yend = yend),
size = 1, col = "midnightblue", linetype = 2)
# load ggplot2, grideExtra, grid, dplyr, and he used glmmTMB for modeling
# img.file <- system.file(file.path("images", "background-image.png"), package = "ggpubr")
img <- png::readPNG("ozone.png")
# need to filter current data for zone potentially - example was all purely offensive zone
p1 <- ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 17),
legend.position ="none") +
ggtitle("Offensive Zone Shot Data") +
# subtitle with team name focused on + game
coord_fixed(xlim = c(0, 85), ylim = c(100, 200)) +
geom_rect(aes(xmin = 10, xmax = 75, ymin = 103, ymax = 110), colour = "black", size = 1, fill = "lightblue") +
annotate("text", label = "Expected Shooting %: 6.3%", x = 42.5, y = 107, size = 5) +
geom_segment(data = data.frame(x = c(38.25, 38.25, 20.75, 20.75, 64.25, 64.25),
y = c(188, 188, 168.5, 153.5, 153.5, 168.5),
xend = c(46.75, 20.75, 20.75, 64.25, 64.25, 46.75),
yend = c(188, 168.5, 153.5, 153.5, 168.5, 188),
aes(x = x, y = y, xend = xend, yend = yend),
size = 1, col = "midnightblue", linetype = 2))
# load ggplot2, grideExtra, grid, dplyr, and he used glmmTMB for modeling
# img.file <- system.file(file.path("images", "background-image.png"), package = "ggpubr")
img <- png::readPNG("ozone.png")
# need to filter current data for zone potentially - example was all purely offensive zone
p1 <- ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 17),
legend.position ="none") +
ggtitle("Offensive Zone Shot Data") +
# subtitle with team name focused on + game
coord_fixed(xlim = c(0, 85), ylim = c(100, 200)) +
geom_rect(aes(xmin = 10, xmax = 75, ymin = 103, ymax = 110), colour = "black", size = 1, fill = "lightblue") +
annotate("text", label = "Expected Shooting %: 6.3%", x = 42.5, y = 107, size = 5) +
geom_segment(data = data.frame(x = c(38.25, 38.25, 20.75, 20.75, 64.25, 64.25),
y = c(188, 188, 168.5, 153.5, 153.5, 168.5),
xend = c(46.75, 20.75, 20.75, 64.25, 64.25, 46.75),
yend = c(188, 168.5, 153.5, 153.5, 168.5, 188)),
aes(x = x, y = y, xend = xend, yend = yend),
size = 1, col = "midnightblue", linetype = 2)
ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 17),
legend.position ="none") +
ggtitle("Offensive Zone Shot Data") +
# subtitle with team name focused on + game
coord_fixed(xlim = c(0, 85), ylim = c(100, 200)) +
geom_rect(aes(xmin = 10, xmax = 75, ymin = 103, ymax = 110), colour = "black", size = 1, fill = "lightblue") +
annotate("text", label = "Expected Shooting %: 6.3%", x = 42.5, y = 107, size = 5) +
geom_segment(data = data.frame(x = c(38.25, 38.25, 20.75, 20.75, 64.25, 64.25),
y = c(188, 188, 168.5, 153.5, 153.5, 168.5),
xend = c(46.75, 20.75, 20.75, 64.25, 64.25, 46.75),
yend = c(188, 168.5, 153.5, 153.5, 168.5, 188)),
aes(x = x, y = y, xend = xend, yend = yend),
size = 1, col = "midnightblue", linetype = 2)
# load ggplot2, grideExtra, grid, dplyr, and he used glmmTMB for modeling
# img.file <- system.file(file.path("images", "background-image.png"), package = "ggpubr")
img <- png::readPNG("ozone.png")
# need to filter current data for zone potentially - example was all purely offensive zone
p1 <- ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 17),
legend.position ="none") +
ggtitle("Offensive Zone Shot Data") +
# subtitle with team name focused on + game
coord_fixed(xlim = c(0, 85), ylim = c(100, 200)) +
# geom_rect(aes(xmin = 10, xmax = 75, ymin = 103, ymax = 110), colour = "black", size = 1, fill = "lightblue") +
# annotate("text", label = "Expected Shooting %: 6.3%", x = 42.5, y = 107, size = 5) +
geom_segment(data = data.frame(x = c(38.25, 38.25, 20.75, 20.75, 64.25, 64.25),
y = c(188, 188, 168.5, 153.5, 153.5, 168.5),
xend = c(46.75, 20.75, 20.75, 64.25, 64.25, 46.75),
yend = c(188, 168.5, 153.5, 153.5, 168.5, 188)),
aes(x = x, y = y, xend = xend, yend = yend),
size = 1, col = "midnightblue", linetype = 2)
# load ggplot2, grideExtra, grid, dplyr, and he used glmmTMB for modeling
# img.file <- system.file(file.path("images", "background-image.png"), package = "ggpubr")
img <- png::readPNG("ozone.png")
# need to filter current data for zone potentially - example was all purely offensive zone
p1 <- ggplot(data = data %>% filter(event_type == "Shot"), aes(x = y_event, y = x_event)) + # x and y are location on rink
#  plot rink
annotation_raster(img, xmin = 0, xmax = 85, ymin = 100, ymax = 200) +
scale_x_continuous(limits = c(0,85), expand = c(0,0)) +
scale_y_continuous(limits = c(100,200), expand = c(0,0)) + # base amount should work by here
# geom_point() +
#  add density
stat_density_2d(geom = "polygon", aes(alpha = stat(level)), fill = "royalblue4", alpha = 0.2, col = "white", bins = 8) +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x =element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 17),
legend.position ="none") +
ggtitle("Offensive Zone Shot Data") +
# subtitle with team name focused on + game
coord_fixed(xlim = c(0, 85), ylim = c(100, 200)) +
# geom_rect(aes(xmin = 10, xmax = 75, ymin = 103, ymax = 110), colour = "black", size = 1, fill = "lightblue") +
# annotate("text", label = "Expected Shooting %: 6.3%", x = 42.5, y = 107, size = 5) +
geom_segment(data = data.frame(x = c(38.25, 38.25, 20.75, 20.75, 64.25, 64.25),
y = c(188, 188, 168.5, 153.5, 153.5, 168.5),
xend = c(46.75, 20.75, 20.75, 64.25, 64.25, 46.75),
yend = c(188, 168.5, 153.5, 153.5, 168.5, 188)),
aes(x = x, y = y, xend = xend, yend = yend),
size = 1, col = "midnightblue", linetype = 2)
p1
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
View(data_women)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
